z_cost1:--z_cost1
declare @t_xmon nvarchar(20)
set @t_xmon = case when '#non' = [4] then '' else [4] end
---------------------------------------------------------------------------

select '0' gno,a.typea,a.productno,
(case when isnull(b.product,'')='' then a.productno else b.product end) product,
b.unit,
dbo.getComma(a.beginmount,[1]) beginmount,
dbo.getComma(a.beginweight,[2]) beginweight,
dbo.getComma(a.beginmoney,0) beginmoney,
dbo.getComma((case when (case when UPPER(isnull(b.unit,''))!='KG' then a.beginmount else a.beginweight end)!=0 then a.beginmoney/(case when UPPER(isnull(b.unit,''))!='KG' then a.beginmount else a.beginweight end) else 0 end),[3]) beginprice,
dbo.getComma(a.inmount,[1]) inmount,
dbo.getComma(a.inweight,[2]) inweight,
dbo.getComma(a.inmoney,0) inmoney,
dbo.getComma((case when (case when UPPER(isnull(b.unit,''))!='KG' then a.inmount else a.inweight end)!=0 then a.inmoney/(case when UPPER(isnull(b.unit,''))!='KG' then a.inmount else a.inweight end) else 0 end),[3]) inprice,
dbo.getComma(a.bornmount,[1]) bornmount,
dbo.getComma(a.bornweight,[2]) bornweight,
dbo.getComma(a.bornmoney,0) bornmoney,
dbo.getComma(a.outsmount,[1]) outsmount,
dbo.getComma(a.outsweight,[2]) outsweight,
dbo.getComma(a.outsmoney,0) outsmoney,
dbo.getComma(a.beginmount+a.inmount+a.bornmount+a.outsmount,[1]) tmount,
dbo.getComma(a.beginweight+a.inweight+a.bornweight+a.outsweight,[1]) tweight,
dbo.getComma(a.beginmoney+a.inmoney+a.bornmoney+a.outsmoney,0) tmoney,
dbo.getComma(a.salemount,[1]) salemount,
dbo.getComma(a.saleweight,[2]) saleweight,
dbo.getComma(a.salemoney,0) salemoney,
dbo.getComma(a.salecost,0) salecost,
dbo.getComma(a.outmount,[1]) outmount,
dbo.getComma(a.outweight,[2]) outweight,
dbo.getComma(a.outmoney,0) outmoney,
dbo.getComma(a.outvmount,[1]) outvmount,
dbo.getComma(a.outvweight,[2]) outvweight,
dbo.getComma(a.outvmoney,0) outvmoney,
dbo.getComma(a.backmount,[1]) backmount,
dbo.getComma(a.backweight,[2]) backweight,
dbo.getComma(a.backmoney,0) backmoney,
dbo.getComma(a.othermount,[1]) othermount,
dbo.getComma(a.otherweight,[2]) otherweight,
dbo.getComma(a.othermoney,0) othermoney,
dbo.getComma(a.lastmount,[1]) lastmount,
dbo.getComma(a.lastweight,[2]) lastweight,
dbo.getComma(a.lastmoney,0) lastmoney,
dbo.getComma(a.price,[3]) price,
dbo.getComma(a.sampmount,[1]) sampmount,
dbo.getComma(a.sampweight,[2]) sampweight,
dbo.getComma(a.sampmoney,0) sampmoney,
dbo.getComma(a.uccemount,[1]) uccemount,
dbo.getComma(a.ucceweight,[2]) ucceweight,
dbo.getComma(a.uccemoney,0) uccemoney
from view_costs a left join view_ucaucc b on a.productno=b.noa
where a.mon=@t_xmon order by a.productno
;