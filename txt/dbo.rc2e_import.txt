CREATE function [dbo].[rc2e_import](
	@t_noa nvarchar(50)
	,@t_tggno nvarchar(50)
)
returns @tmpa table(
	Storeno nvarchar(50)
	,Store nvarchar(50)
	,Ordeno nvarchar(50)
	,No2 nvarchar(50)
	,Style nvarchar(50)
	,Productno nvarchar(50)
	,Product nvarchar(50)
	,Uno nvarchar(50)
	,Spec nvarchar(50)
	,Width float
	,Dime float
	,Lengthb float
	,Weight float
	,Gweight float
	,Class nvarchar(50)
	,Width2 float
	,Size nvarchar(50)
	,Mount float
	,Unit nvarchar(50)
)as
BEGIN
	declare @tmp table(
		 noa nvarchar(50)
		,tggno nvarchar(50)

		,Storeno nvarchar(50)
		,Store nvarchar(50)
		,Ordeno nvarchar(50)
		,No2 nvarchar(50)
		,Style nvarchar(50)
		,Productno nvarchar(50)
		,Product nvarchar(50)
		,Uno nvarchar(50)
		,Spec nvarchar(50)
		,Width float
		,Dime float
		,Lengthb float
		,Weight float
		,Gweight float
		,Class nvarchar(50)
		,Width2 float
		,Size nvarchar(50)
		,Mount float
		,Unit nvarchar(50)
		,Price float
		,Meno nvarchar(max)
	)
	INSERT into @tmp
	SELECT a.noa,a.tggno,b.storeno,b.store,b.descr,b.noq,b.style,b.productno,b.product,b.uno,b.surface,b.width,b.dime,b.lengthb,b.weights,b.weight,b.class,b.widths,b.hand,b.mount,b.unit,b.price,b.memo
	from rc2e a
	left join rc2es b on a.noa = b.noa
	where tggno=@t_tggno

	insert into @tmpa
	SELECT Storeno,Store,Ordeno,No2,Style,Productno,Product,Uno,Spec,Width,Dime,Lengthb,Weight,Gweight,Class,Width2,Size,Mount,Unit,Price,Memo from @tmp 
	
	return
END